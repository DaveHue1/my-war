#####
#Upgrade advisors
#Author: DaveHue
#####

execute if score @s mywar.current_conquest_level = #mywar.upgrade1 mywar.dummy run execute as @e[type=villager,limit=2,sort=nearest,tag=mywar.advisor,tag=mywar.entity,tag=mywar.advisor_merged,distance=..50] at @s run data merge entity @s {Invulnerable:1b,CustomNameVisible:1b,Tags:["mywar.advisor","mywar.advisor_merged"],CustomName:'{"translate":"mywar.mob.name.advisor","color":"aqua","bold":false,"italic":false}',VillagerData:{profession:"minecraft:nitwit"},Offers:{Recipes:[{rewardExp:0b,maxUses:2147483647,buy:{id:'minecraft:structure_block',Count:5b,tag:{display:{Name:'{"translate":"mywar.item.name.money","color":"yellow","bold":false,"italic":false}'},CustomModelData:1,mywar.currency:1b,mywar.item:1b}},sell:{id:'minecraft:cooked_beef',Count:1b}},{rewardExp:0b,maxUses:2147483647,buy:{id:'minecraft:structure_block',Count:10b,tag:{display:{Name:'{"translate":"mywar.item.name.money","color":"yellow","bold":false,"italic":false}'},CustomModelData:1,mywar.currency:1b,mywar.item:1b}},sell:{id:'minecraft:bow',Count:1b}},{rewardExp:0b,maxUses:2147483647,buy:{id:'minecraft:structure_block',Count:2b,tag:{display:{Name:'{"translate":"mywar.item.name.money","color":"yellow","bold":false,"italic":false}'},CustomModelData:1,mywar.currency:1b,mywar.item:1b}},sell:{id:'minecraft:arrow',Count:1b}},{rewardExp:0b,maxUses:2147483647,buy:{id:'minecraft:structure_block',Count:2b,tag:{display:{Name:'{"translate":"mywar.item.name.money","color":"yellow","bold":false,"italic":false}'},CustomModelData:1,mywar.currency:1b,mywar.item:1b}},sell:{id:'minecraft:structure_void',Count:1b,tag:{display:{Name:'{"translate":"mywar.mob.name.foot_soldier","color":"yellow","italic":false}'},CustomModelData:1,mywar.foot_soldier:1b,mywar.trade_item:1b}}},{rewardExp:0b,maxUses:2147483647,buy:{id:'minecraft:structure_block',Count:2b,tag:{display:{Name:'{"translate":"mywar.item.name.money","color":"yellow","bold":false,"italic":false}'},CustomModelData:1,mywar.currency:1b,mywar.item:1b,BlockEntityTag:{rotation:'NONE',mirror:'NONE',mode:'SAVE'}}},sell:{id:'minecraft:structure_void',Count:1b,tag:{display:{Name:'{"translate":"mywar.mob.name.archer","color":"yellow","italic":false}'},CustomModelData:2,mywar.archer:1b,mywar.trade_item:1b}}},{rewardExp:0b,maxUses:2147483647,buy:{id:'minecraft:structure_block',Count:64b,tag:{display:{Name:'{"translate":"mywar.item.name.money","color":"yellow","bold":false,"italic":false}'},CustomModelData:1,mywar.currency:1b,mywar.item:1b}},sell:{id:'minecraft:structure_block',Count:1b,tag:{display:{Name:'{"text":"Stack of Money","color":"yellow","italic":false}'},CustomModelData:2,mywar.item:1b,mywar.stack_of_money:1b}}},{rewardExp:0b,maxUses:2147483647,buy:{id:'minecraft:structure_block',Count:1b,tag:{display:{Name:'{"text":"Stack of Money","color":"yellow","italic":false}'},CustomModelData:2,mywar.item:1b,mywar.stack_of_money:1b}},sell:{id:'minecraft:structure_block',Count:64b,tag:{display:{Name:'{"translate":"mywar.item.name.money","color":"yellow","bold":false,"italic":false}'},CustomModelData:1,mywar.currency:1b,mywar.item:1b}}}]}} 
execute if score @s mywar.current_conquest_level = #mywar.upgrade1 mywar.dummy run tellraw @s {"translate":"mywar.message.village.upgrade","with":[{"translate":"mywar.mob.name.archer"}],"color":"yellow"}

execute if score @s mywar.current_conquest_level = #mywar.upgrade2 mywar.dummy run execute as @e[type=villager,limit=2,sort=nearest,tag=mywar.advisor,tag=mywar.entity,tag=mywar.advisor_merged,distance=..50] at @s run data merge entity @s {Invulnerable:1b,CustomNameVisible:1b,Tags:["mywar.advisor","mywar.advisor_merged"],CustomName:'{"translate":"mywar.mob.name.advisor","color":"aqua","bold":false,"italic":false}',VillagerData:{profession:"minecraft:nitwit"},Offers:{Recipes:[{rewardExp:0b,maxUses:2147483647,buy:{id:'minecraft:structure_block',Count:5b,tag:{display:{Name:'{"translate":"mywar.item.name.money","color":"yellow","bold":false,"italic":false}'},CustomModelData:1,mywar.currency:1b,mywar.item:1b}},sell:{id:'minecraft:cooked_beef',Count:1b}},{rewardExp:0b,maxUses:2147483647,buy:{id:'minecraft:structure_block',Count:10b,tag:{display:{Name:'{"translate":"mywar.item.name.money","color":"yellow","bold":false,"italic":false}'},CustomModelData:1,mywar.currency:1b,mywar.item:1b}},sell:{id:'minecraft:bow',Count:1b}},{rewardExp:0b,maxUses:2147483647,buy:{id:'minecraft:structure_block',Count:2b,tag:{display:{Name:'{"translate":"mywar.item.name.money","color":"yellow","bold":false,"italic":false}'},CustomModelData:1,mywar.currency:1b,mywar.item:1b}},sell:{id:'minecraft:arrow',Count:1b}},{rewardExp:0b,maxUses:2147483647,buy:{id:'minecraft:structure_block',Count:32b,tag:{display:{Name:'{"translate":"mywar.item.name.money","color":"yellow","bold":false,"italic":false}'},CustomModelData:1,mywar.currency:1b,mywar.item:1b}},sell:{id:'minecraft:diamond',Count:1b}},{rewardExp:0b,maxUses:2147483647,buy:{id:'minecraft:structure_block',Count:2b,tag:{display:{Name:'{"translate":"mywar.item.name.money","color":"yellow","bold":false,"italic":false}'},CustomModelData:1,mywar.currency:1b,mywar.item:1b}},sell:{id:'minecraft:structure_void',Count:1b,tag:{display:{Name:'{"translate":"mywar.mob.name.foot_soldier","color":"yellow","italic":false}'},CustomModelData:1,mywar.foot_soldier:1b,mywar.trade_item:1b}}},{rewardExp:0b,maxUses:2147483647,buy:{id:'minecraft:structure_block',Count:4b,tag:{display:{Name:'{"translate":"mywar.item.name.money","color":"yellow","bold":false,"italic":false}'},CustomModelData:1,mywar.currency:1b,mywar.item:1b}},sell:{id:'minecraft:structure_void',Count:1b,tag:{display:{Name:'{"translate":"mywar.mob.name.archer","color":"yellow","italic":false}'},CustomModelData:2,mywar.archer:1b,mywar.trade_item:1b}}},{rewardExp:0b,maxUses:2147483647,buy:{id:'minecraft:structure_block',Count:4b,tag:{display:{Name:'{"translate":"mywar.item.name.money","color":"yellow","bold":false,"italic":false}'},CustomModelData:1,mywar.currency:1b,mywar.item:1b}},sell:{id:'minecraft:structure_void',Count:1b,tag:{display:{Name:'{"translate":"mywar.mob.name.swordsman","color":"yellow","italic":false}'},CustomModelData:3,mywar.swordsmen:1b,mywar.trade_item:1b}}},{rewardExp:0b,maxUses:2147483647,buy:{id:"minecraft:structure_block",Count:64b,tag:{display:{Name:'{"translate":"mywar.item.name.money","color":"yellow","bold":false,"italic":false}'},CustomModelData:1,mywar.currency:1b,mywar.item:1b}},sell:{id:"minecraft:structure_block",Count:1b,tag:{display:{Name:'{"text":"Stack of Money","color":"yellow","italic":false}'},CustomModelData:2,mywar.item:1b,mywar.stack_of_money:1b}}},{rewardExp:0b,maxUses:2147483647,buy:{id:"minecraft:structure_block",Count:1b,tag:{display:{Name:'{"text":"Stack of Money","color":"yellow","italic":false}'},CustomModelData:2,mywar.item:1b,mywar.stack_of_money:1b}},sell:{id:"minecraft:structure_block",Count:64b,tag:{display:{Name:'{"translate":"mywar.item.name.money","color":"yellow","bold":false,"italic":false}'},CustomModelData:1,mywar.currency:1b,mywar.item:1b}}}]}}
execute if score @s mywar.current_conquest_level = #mywar.upgrade2 mywar.dummy run tellraw @s {"translate":"mywar.message.village.upgrade","with":[{"translate":"mywar.mob.name.swordsman"}],"color":"yellow"}

execute if score @s mywar.current_conquest_level = #mywar.upgrade3 mywar.dummy run execute as @e[type=villager,limit=2,sort=nearest,tag=mywar.advisor,tag=mywar.entity,tag=mywar.advisor_merged,distance=..50] at @s run data merge entity @s {Invulnerable:1b,CustomNameVisible:1b,Tags:["mywar.advisor","mywar.advisor_merged"],CustomName:'{"translate":"mywar.mob.name.advisor","color":"aqua","bold":false,"italic":false}',VillagerData:{profession:"minecraft:nitwit"},Offers:{Recipes:[{rewardExp:0b,maxUses:2147483647,buy:{id:'minecraft:structure_block',Count:5b,tag:{display:{Name:'{"translate":"mywar.item.name.money","color":"yellow","bold":false,"italic":false}'},CustomModelData:1,mywar.currency:1b,mywar.item:1b}},sell:{id:'minecraft:cooked_beef',Count:1b}},{rewardExp:0b,maxUses:2147483647,buy:{id:'minecraft:structure_block',Count:10b,tag:{display:{Name:'{"translate":"mywar.item.name.money","color":"yellow","bold":false,"italic":false}'},CustomModelData:1,mywar.currency:1b,mywar.item:1b}},sell:{id:'minecraft:bow',Count:1b}},{rewardExp:0b,maxUses:2147483647,buy:{id:'minecraft:structure_block',Count:2b,tag:{display:{Name:'{"translate":"mywar.item.name.money","color":"yellow","bold":false,"italic":false}'},CustomModelData:1,mywar.currency:1b,mywar.item:1b}},sell:{id:'minecraft:arrow',Count:1b}},{rewardExp:0b,maxUses:2147483647,buy:{id:'minecraft:structure_block',Count:32b,tag:{display:{Name:'{"translate":"mywar.item.name.money","color":"yellow","bold":false,"italic":false}'},CustomModelData:1,mywar.currency:1b,mywar.item:1b}},sell:{id:'minecraft:diamond',Count:1b}},{rewardExp:0b,maxUses:2147483647,buy:{id:'minecraft:structure_block',Count:2b,tag:{display:{Name:'{"translate":"mywar.item.name.money","color":"yellow","bold":false,"italic":false}'},CustomModelData:1,mywar.currency:1b,mywar.item:1b}},sell:{id:'minecraft:structure_void',Count:1b,tag:{display:{Name:'{"translate":"mywar.mob.name.foot_soldier","color":"yellow","italic":false}'},CustomModelData:1,mywar.foot_soldier:1b}}},{rewardExp:0b,maxUses:2147483647,buy:{id:'minecraft:structure_block',Count:4b,tag:{display:{Name:'{"translate":"mywar.item.name.money","color":"yellow","bold":false,"italic":false}'},CustomModelData:1,mywar.currency:1b,mywar.item:1b}},sell:{id:'minecraft:structure_void',Count:1b,tag:{display:{Name:'{"translate":"mywar.mob.name.archer","color":"yellow","italic":false}'},CustomModelData:2,mywar.archer:1b}}},{rewardExp:0b,maxUses:2147483647,buy:{id:'minecraft:structure_block',Count:4b,tag:{display:{Name:'{"translate":"mywar.item.name.money","color":"yellow","bold":false,"italic":false}'},CustomModelData:1,mywar.currency:1b,mywar.item:1b}},sell:{id:'minecraft:structure_void',Count:1b,tag:{display:{Name:'{"translate":"mywar.mob.name.swordsman","color":"yellow","italic":false}'},CustomModelData:3,mywar.swordsmen:1b}}},{rewardExp:0b,maxUses:2147483647,buy:{id:'minecraft:structure_block',Count:6b,tag:{display:{Name:'{"translate":"mywar.item.name.money","color":"yellow","bold":false,"italic":false}'},CustomModelData:1,mywar.currency:1b,mywar.item:1b}},sell:{id:'minecraft:structure_void',Count:1b,tag:{display:{Name:'{"translate":"mywar.mob.name.knight","color":"yellow","italic":false}'},CustomModelData:4,mywar.knight:1b}}},{rewardExp:0b,maxUses:2147483647,buy:{id:"minecraft:structure_block",Count:64b,tag:{display:{Name:'{"translate":"mywar.item.name.money","color":"yellow","bold":false,"italic":false}'},CustomModelData:1,mywar.currency:1b,mywar.item:1b}},sell:{id:"minecraft:structure_block",Count:1b,tag:{display:{Name:'{"text":"Stack of Money","color":"yellow","italic":false}'},CustomModelData:2,mywar.item:1b,mywar.stack_of_money:1b}}},{rewardExp:0b,maxUses:2147483647,buy:{id:"minecraft:structure_block",Count:1b,tag:{display:{Name:'{"text":"Stack of Money","color":"yellow","italic":false}'},CustomModelData:2,mywar.item:1b,mywar.stack_of_money:1b}},sell:{id:"minecraft:structure_block",Count:64b,tag:{display:{Name:'{"translate":"mywar.item.name.money","color":"yellow","bold":false,"italic":false}'},CustomModelData:1,mywar.currency:1b,mywar.item:1b}}}]}}
execute if score @s mywar.current_conquest_level = #mywar.upgrade3 mywar.dummy run tellraw @s {"translate":"mywar.message.village.upgrade","with":[{"translate":"mywar.mob.name.knight"}],"color":"yellow"}

execute if score @s mywar.current_conquest_level = #mywar.upgrade4 mywar.dummy run execute as @e[type=villager,limit=2,sort=nearest,tag=mywar.advisor,tag=mywar.entity,tag=mywar.advisor_merged,distance=..50] at @s run data merge entity @s {Invulnerable:1b,CustomNameVisible:1b,Tags:["mywar.advisor","mywar.advisor_merged"],CustomName:'{"translate":"mywar.mob.name.advisor","color":"aqua","bold":false,"italic":false}',VillagerData:{profession:"minecraft:nitwit"},Offers:{Recipes:[{rewardExp:0b,maxUses:2147483647,buy:{id:'minecraft:structure_block',Count:5b,tag:{display:{Name:'{"translate":"mywar.item.name.money","color":"yellow","bold":false,"italic":false}'},CustomModelData:1,mywar.currency:1b,mywar.item:1b}},sell:{id:'minecraft:cooked_beef',Count:1b}},{rewardExp:0b,maxUses:2147483647,buy:{id:'minecraft:structure_block',Count:10b,tag:{display:{Name:'{"translate":"mywar.item.name.money","color":"yellow","bold":false,"italic":false}'},CustomModelData:1,mywar.currency:1b,mywar.item:1b}},sell:{id:'minecraft:bow',Count:1b}},{rewardExp:0b,maxUses:2147483647,buy:{id:'minecraft:structure_block',Count:2b,tag:{display:{Name:'{"translate":"mywar.item.name.money","color":"yellow","bold":false,"italic":false}'},CustomModelData:1,mywar.currency:1b,mywar.item:1b}},sell:{id:'minecraft:arrow',Count:1b}},{rewardExp:0b,maxUses:2147483647,buy:{id:'minecraft:structure_block',Count:32b,tag:{display:{Name:'{"translate":"mywar.item.name.money","color":"yellow","bold":false,"italic":false}'},CustomModelData:1,mywar.currency:1b,mywar.item:1b}},sell:{id:'minecraft:diamond',Count:1b}},{rewardExp:0b,maxUses:2147483647,buy:{id:'minecraft:structure_block',Count:64b,tag:{display:{Name:'{"translate":"mywar.item.name.money","color":"yellow","bold":false,"italic":false}'},CustomModelData:1,mywar.currency:1b,mywar.item:1b}},buyB:{id:'minecraft:structure_block',Count:32b,tag:{display:{Name:'{"translate":"mywar.item.name.money","color":"yellow","bold":false,"italic":false}'},CustomModelData:1,mywar.currency:1b,mywar.item:1b}},sell:{id:'minecraft:netherite_ingot',Count:1b}},{rewardExp:0b,maxUses:2147483647,buy:{id:'minecraft:structure_block',Count:2b,tag:{display:{Name:'{"translate":"mywar.item.name.money","color":"yellow","bold":false,"italic":false}'},CustomModelData:1,mywar.currency:1b,mywar.item:1b}},sell:{id:"minecraft:structure_void",Count:1b,tag:{display:{Name:'{"translate":"mywar.mob.name.foot_soldier","color":"yellow","italic":false}'},CustomModelData:1,mywar.foot_soldier:1b,mywar.trade_item:1b}}},{rewardExp:0b,maxUses:2147483647,buy:{id:'minecraft:structure_block',Count:4b,tag:{display:{Name:'{"translate":"mywar.item.name.money","color":"yellow","bold":false,"italic":false}'},CustomModelData:1,mywar.currency:1b,mywar.item:1b}},sell:{id:"minecraft:structure_void",Count:1b,tag:{display:{Name:'{"translate":"mywar.mob.name.archer","color":"yellow","italic":false}'},CustomModelData:2,mywar.archer:1b,mywar.trade_item:1b}}},{rewardExp:0b,maxUses:2147483647,buy:{id:'minecraft:structure_block',Count:4b,tag:{display:{Name:'{"translate":"mywar.item.name.money","color":"yellow","bold":false,"italic":false}'},CustomModelData:1,mywar.currency:1b,mywar.item:1b}},sell:{id:"minecraft:structure_void",Count:1b,tag:{display:{Name:'{"translate":"mywar.mob.name.swordsman","color":"yellow","italic":false}'},CustomModelData:3,mywar.swordsmen:1b,mywar.trade_item:1b}}},{rewardExp:0b,maxUses:2147483647,buy:{id:'minecraft:structure_block',Count:6b,tag:{display:{Name:'{"translate":"mywar.item.name.money","color":"yellow","bold":false,"italic":false}'},CustomModelData:1,mywar.currency:1b,mywar.item:1b}},sell:{id:"minecraft:structure_void",Count:1b,tag:{display:{Name:'{"translate":"mywar.mob.name.knight","color":"yellow","italic":false}'},CustomModelData:4,mywar.knight:1b,mywar.trade_item:1b}}},{rewardExp:0b,maxUses:2147483647,buy:{id:'minecraft:structure_block',Count:4b,tag:{display:{Name:'{"translate":"mywar.item.name.money","color":"yellow","bold":false,"italic":false}'},CustomModelData:1,mywar.currency:1b,mywar.item:1b}},sell:{id:"minecraft:structure_void",Count:1b,tag:{display:{Name:'{"translate":"mywar.mob.name.mage","color":"yellow","italic":false}'},CustomModelData:5,mywar.mage:1b,mywar.trade_item:1b}}}]}}
execute if score @s mywar.current_conquest_level = #mywar.upgrade4 mywar.dummy run tellraw @s {"translate":"mywar.message.village.upgrade","with":[{"translate":"mywar.mob.name.mage"}],"color":"yellow"}

#Tags removal
tag @s remove mywar.upgrade_pending
